cat("~~ Model Production: Started ~~\n")
# Sets working directory to dataset location
setwd("c:/Users/thomaspickup/icloudDrive/Documents/University/CSC3002/Assignment/CSC3002-Project/Dataset")
cat("- Importing Libraries\n")
library(caret)
library(e1071)
library(Boruta)
# Sets the random seed to ensure repeatability
set.seed(3002)
cat("- Importing Dataset as CSV\n")
api.csv<-read.csv("api_results.csv")
sample.csv<-read.csv("sample_list.csv")
malware.csv<-read.csv("malware_types.csv")
# Merges together to create one data frame
ds<-merge(x=api.csv, y=sample.csv, by.x="SampleName", by.y="MD5hash")
mu<-merge(x=ds, y=malware.csv, by="MalwareID")
# Nullifies any identifying data
ds$SampleName<-NULL
ds$SampleID<-NULL
ds$Score<-NULL
# Changes malware ID to be a factor rather than an integer
ds$MalwareID = as.factor(ds$MalwareID)
# Gets the ID of the malwareID column
malwareID_Col <- ncol(ds)
lastFeature_Col <- malwareID_Col - 1
cat("- Performing Boruta Algorithm\n")
ds.boruta <- Boruta(ds[, malwareID_Col]~., data = ds, doTrace = 2)
ds.boruta.final <- TentativeRoughFix(ds.boruta)
ds.selected.attributes<-getSelectedAttributes(ds.boruta.final, withTentative = F)
# Gets the final dataset using only the selected features
ds.final <- ds[,ds.selected.attributes]
malwareID_Col <- ncol(ds.final)
lastFeature_Col <- malwareID_Col - 1
# Create index to split based on labels
index <- createDataPartition(ds.final$MalwareID, p=0.9, list=FALSE)
# Subset training set with index
ds.training <- ds.final[index,]
# Subset test set with index
ds.test <- ds.final[-index,]
trControl <- trainControl(method = "repeatedCV", number = 10, repeats = 3)
model <- train(ds.training[, malwareID_Col] ~., ds.training[, 1-lastFeature_col], method='rpart', params= list(split="information"), trControl=trControl, tuneLength=10)
model <- train(ds.training[, malwareID_Col] ~., ds.training[, 1-lastFeature_Col], method='rpart', params= list(split="information"), trControl=trControl, tuneLength=10)
warnings()
